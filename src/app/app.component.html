<app-header></app-header>

<div class="alert alert-danger" role="alert" *ngIf="!connected">
	<strong>Oh no!</strong> You aren't connected to the backend service.
</div>

<button *ngIf = "comPort == null || cameraPort == null" type="button" class="btn btn-secondary" (click)="open(content)">Add Camera <i class="fas fa-plus"></i></button>
<h6>Current Camera: {{cameraPort ? cameraPort : "None Selected"}}</h6>
<h6>Current Serial Port: {{comPort ? comPort : "None Selected"}}</h6>

<div class="custom-control custom-switch">
	<input #debugSwitch type="checkbox" class="custom-control-input" id="debugSwitch" [checked]="debugMode" (change)="toggleDebugMode(debugSwitch.checked)">
	<label class="custom-control-label" for="debugSwitch">Debug Mode</label>
</div>

<div ngbDropdown container="body"  *ngIf = "comPort != null && cameraPort != null"  >
	<button class="btn  btn-secondary btn-sm" ngbDropdownToggle>Settings <i class="fas fa-cog"></i></button>
	<div ngbDropdownMenu>
		<h6 class="dropdown-header">Settings</h6>
		<button ngbDropdownItem (click)="refreshSerial()">Refresh Serial Ports</button>
		<button ngbDropdownItem (click)="refreshVideoPorts()">Refresh Camera Ports</button>
		<div class="dropdown-divider"></div>
		<button ngbDropdownItem (click)="destroyCamera()">Disconnect from Camera</button>
	</div>
</div>

<div class="row">
    <div class="col">
		<!-- <img style="-webkit-user-select: none;margin: auto;background-color: hsl(0, 0%, 25%);" src="http://localhost:4001/video_feed"> -->
    </div>
    <div class="col">
		<div *ngIf="debugMode">
			<button (click)="connectToCamera()">Hello Connect!</button><br>
			<button (click)="setActiveCOMPort()">Cause Test Exception!</button>

		</div>
	</div>
</div>

<ng-template #content let-modal>
	<div class="modal-header">
	  <h4 class="modal-title" id="modal-basic-title">Add Camera</h4>
	  <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
		<span aria-hidden="true">&times;</span>
	  </button>
	</div>
	<div class="modal-body">
	  <form>
		<div class="form-group">
		  <label for="visca-serial-port">VISCA Serial Port</label>
		  <select class="form-select" aria-label="Default select example">
			<option *ngFor="let com of availableCom; let i = index" [value]="availableCom[i]">
				{{com}}
			</option>
		  </select>
		  <br>
		  <label for="visca-camera-port">VISCA Camera Port</label>
		  <select class="form-select" aria-label="Default select example">
				<option *ngFor="let camera of availableVideo; let i = index" [value]="availableVideo[i]">
					{{camera}}
				</option>
			</select>
		</div>
	  </form>
	</div>
	<div class="modal-footer">
	  <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Connect</button>
	</div>
  </ng-template>

<router-outlet></router-outlet>
